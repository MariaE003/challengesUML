create database products;

1- Afficher le nombre total de clients. => select count(*) from clients;

2- Afficher le nombre total de commandes. => select count(*) from commandes;

3- Afficher le nombre de commandes par client. => select client_id,count(*) as nbr_commantde from commandes group by client_id;

Moyenne:

1- Afficher le montant moyen des commandes. => select avg(total) as montant from commandes;

2- Afficher le prix moyen des produits. => select avg(prix) as prix from produits;

3- Afficher le montant moyen des commandes par client. =>  select client_id,avg(total) as montant from commandes group by client_id;

SOMME

1- Afficher le total des ventes. => select sum(total) as total from commandes;

2- Afficher le total des ventes par client. => select client_id,sum(total) as total from commandes group by client_id;

3- Afficher le chiffre d'affaires par ville. => select c.ville,(p.prix * cp.quantite) from commande_produit cp inner join produits p on p.id=cp.produit_id inner join commandes co on co.id=cp.commande_id inner join clients c on c.id=co.client_id group by c.ville ,(p.prix * cp.quantite);

MAX / MIN

1- Afficher le prix du produit le plus cher. => select max(prix) from produits;

2- Afficher le montant de la commande la moins chère. => select min(total) from commandes;

3- Afficher le montant maximum des commandes par client. => select client_id, max(total) from commandes group by client_id;

GROUPER PAR

1- Afficher le nombre de clients par ville. =>select ville,count(*) from clients group by ville;

2- Afficher le nombre de commandes par client. => select client_id,count(*) from commandes group by client_id ;

3- Afficher le chiffre d'affaires par client. => select c.id,(p.prix * cp.quantite) from commande_produit cp inner join produits p on p.id=cp.produit_id inner join commandes co on co.id=cp.commande_id inner join clients c on c.id=co.client_id group by c.id ,(p.prix * cp.quantite);


CLASSER PAR

1- Afficher les produits classés par prix croissant. => select prix from produits order by prix asc;

2- Afficher les commandes classées par date décroissante. => select * from commandes order by date_commande;

3- Afficher les clients classés par chiffre d'affaires décroissant. =>
select c.id,sum(p.prix * cp.quantite) as chiffre_daffaire from clients c inner join commandes co on co.client_id=c.id inner join commande_produit cp on co.id=cp.commande_id inner join produits p on p.id=cp.produit_id group by c.id order by chiffre_daffaire desc;


AYANT

1- Afficher les clients ayant passé plus d'une commande. =>select c.id, count(*) as nbr from clients c inner join commandes co on co.client_id=c.id group by c.id having nbr>1;

2- Afficher les villes ayant plus de deux clients. => select ville,count(*) from clients group by ville having count(*)>=2;

3- Afficher les clients dont le chiffre d'affaires dépasse un seuil donné. =>
select c.id,sum(p.prix * cp.quantite) as chiffre_daffaire from clients c inner join commandes co on co.client_id=c.id inner join commande_produit cp on co.id=cp.commande_id inner join produits p on p.id=cp.produit_id group by c.id having chiffre_daffaire>7000;

REJOINDRE

1- Afficher les commandes avec le nom du client. =>select c.nom,co.* from commandes co inner join clients c on c.id=co.client_id;

2- Afficher les produits commandés avec leurs quantités.=>select p.*,cp.quantite from produits p inner join commande_produit cp on cp.produit_id=p.id;

3- Afficher le détail des commandes (client, produit, quantité). =>

